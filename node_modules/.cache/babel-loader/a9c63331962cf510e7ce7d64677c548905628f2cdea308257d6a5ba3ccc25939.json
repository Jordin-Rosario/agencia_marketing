{"ast":null,"code":"import Footer from'components/navigations/Footer';import Navbar from'components/navigations/Navbar';import Layouts from'hocs/layouts/Layouts';import React,{useEffect,useState}from'react';import{getCookie}from'components/navigations/csrf_token';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const request=async url=>{const res=await fetch(url);if(!res.ok){throw new Error('Error en la solicitud');}const data=await res.json();return data;};const deleteProducto=async id=>{try{const csrfToken=getCookie('csrftoken');const response=await fetch(`http://127.0.0.1:8000/agencia/servicios/${id}/`,{method:'DELETE',headers:{'Content-Type':'application/json','X-CSRFToken':csrfToken// Incluye el token CSRF en el encabezado\n}});if(!response.ok){throw new Error('Error en la solicitud');}return response;// Devuelve la respuesta de la solicitud\n}catch(error){console.error(\"Hubo un error al eliminar el usuario:\",error);throw error;// Lanza el error para que el componente lo maneje\n}};const Home=()=>{var _productos$results;const[productos,setProductos]=useState({});const[pages,setPages]=useState([]);const[pageActive,setPageActive]=useState();useEffect(()=>{let calPages=productos['count']/5;calPages=!calPages%2==0?calPages+1:calPages;const pages=[];for(let page=1;page<calPages;page++){pages.push({numberPage:page,url:`http://127.0.0.1:8000/agencia/servicios/?page=${page}`});};setPages(pages);},[productos]);const fetchData=async url=>{setPageActive(url);try{const data=await request(url);setProductos(data);}catch(error){console.log(\"Ah ocurrido un error\");};};const handleDelete=async id=>{try{await deleteProducto(id);const dataProductoEliminado=productos['results'].filter(producto=>producto.id!=id);setProductos(prevState=>({...prevState,results:dataProductoEliminado}));}catch(err){alert('Ah ocurrido un error');};};useEffect(()=>{fetchData('http://127.0.0.1:8000/agencia/servicios/');},[]);return/*#__PURE__*/_jsxs(Layouts,{children:[/*#__PURE__*/_jsx(Navbar,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"pt-14 container mx-auto\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-4 gap-x-4 gap-y-10\",children:(_productos$results=productos['results'])===null||_productos$results===void 0?void 0:_productos$results.map(producto=>/*#__PURE__*/_jsxs(\"div\",{class:\"flex flex-col mt-6 text-gray-700 bg-gray-100 shadow-md bg-clip-border rounded-xl w-80\",children:[/*#__PURE__*/_jsx(\"div\",{class:\"relative h-56 mx-4 -mt-6 overflow-hidden text-white shadow-lg bg-clip-border rounded-xl bg-blue-gray-500 shadow-blue-gray-500/40\",children:producto.foto&&/*#__PURE__*/_jsx(\"img\",{src:producto.foto,className:\"object-cover w-full h-full\",alt:\"\"})}),/*#__PURE__*/_jsxs(\"div\",{class:\"p-6\",children:[/*#__PURE__*/_jsx(\"h5\",{class:\"block mb-2 font-sans text-xl antialiased font-semibold leading-snug tracking-normal text-blue-gray-900\",children:producto.nombre}),/*#__PURE__*/_jsx(\"p\",{class:\"block font-sans text-base antialiased font-light leading-relaxed text-inherit\",children:producto.descripcion})]}),/*#__PURE__*/_jsx(\"div\",{class:\"p-6 pt-0\",children:/*#__PURE__*/_jsx(\"button\",{class:\"align-middle select-none font-sans font-bold text-center uppercase transition-all disabled:opacity-50 disabled:shadow-none disabled:pointer-events-none text-xs py-3 px-6 rounded-lg bg-gray-900 text-white shadow-md shadow-gray-900/10 hover:shadow-lg hover:shadow-gray-900/20 focus:opacity-[0.85] focus:shadow-none active:opacity-[0.85] active:shadow-none\",onClick:()=>handleDelete(producto.id),children:\"Eliminar producto\"})})]}))}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-2 bg-gray-100 my-2 rounded-lg\",children:[productos['previous']?/*#__PURE__*/_jsx(\"button\",{className:\"bg-blue-500 hover:bg-blue-700 text-white cursor-pointer font-bold py-1.5 px-3 rounded\",onClick:()=>fetchData(productos['previous']),children:\"Anterior\"}):/*#__PURE__*/_jsx(\"button\",{className:\"bg-gray-200 hover:bg-gray-100 text-gray-400 font-bold py-1.5 px-3 rounded\",children:\"Anterior\"}),pages.map(page=>/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"button\",{className:\"hover:underline text-blue-600 font-bold py-2 px-4 rounded\",onClick:()=>fetchData(page['url']),children:page['numberPage']})})),productos['next']?/*#__PURE__*/_jsx(\"button\",{className:\"bg-blue-500 hover:bg-blue-700 text-white font-bold py-1.5 px-3 rounded\",onClick:()=>fetchData(productos['next']),children:\"Siguiente\"}):/*#__PURE__*/_jsx(\"button\",{className:\"bg-gray-200 hover:bg-gray-100 text-gray-400 font-bold py-1.5 px-3 rounded\",children:\"Siguiente\"})]})]}),/*#__PURE__*/_jsx(Footer,{})]});};export default Home;","map":{"version":3,"names":["Footer","Navbar","Layouts","React","useEffect","useState","getCookie","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","request","url","res","fetch","ok","Error","data","json","deleteProducto","id","csrfToken","response","method","headers","error","console","Home","_productos$results","productos","setProductos","pages","setPages","pageActive","setPageActive","calPages","page","push","numberPage","fetchData","log","handleDelete","dataProductoEliminado","filter","producto","prevState","results","err","alert","children","className","map","class","foto","src","alt","nombre","descripcion","onClick"],"sources":["C:/Users/Opdbd09/Desktop/agencia_marketing/src/containers/pages/Home.jsx"],"sourcesContent":["import Footer from 'components/navigations/Footer'\r\nimport Navbar from 'components/navigations/Navbar'\r\nimport Layouts from 'hocs/layouts/Layouts'\r\nimport React, {useEffect, useState} from 'react'\r\nimport { getCookie } from 'components/navigations/csrf_token'\r\n\r\n\r\nconst request = async (url) => {\r\n  const res = await fetch(url)\r\n  if (!res.ok) {\r\n    throw new Error('Error en la solicitud');\r\n  }\r\n  const data = await res.json();\r\n  return data\r\n}\r\n\r\nconst deleteProducto = async (id) => {\r\n  try {\r\n    const csrfToken = getCookie('csrftoken'); \r\n\r\n    const response = await fetch(`http://127.0.0.1:8000/agencia/servicios/${id}/`, {\r\n      method: 'DELETE',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        'X-CSRFToken': csrfToken // Incluye el token CSRF en el encabezado\r\n      },\r\n    });\r\n\r\n    if (!response.ok) {\r\n      throw new Error('Error en la solicitud');\r\n    }\r\n\r\n    return response; // Devuelve la respuesta de la solicitud\r\n  } catch (error) {\r\n    console.error(\"Hubo un error al eliminar el usuario:\", error);\r\n    throw error; // Lanza el error para que el componente lo maneje\r\n  }\r\n};\r\n\r\nconst Home = () => {\r\n  const [productos, setProductos] = useState({});\r\n  const [pages, setPages] = useState([]);\r\n  const [pageActive, setPageActive] = useState();\r\n\r\n  useEffect(() => {\r\n    let calPages = productos['count'] / 5\r\n    calPages = !calPages % 2 == 0 ? calPages + 1: calPages \r\n  \r\n    const pages = []\r\n    for (let page = 1; page < calPages; page++) {\r\n      pages.push({\r\n        numberPage:page,\r\n        url:`http://127.0.0.1:8000/agencia/servicios/?page=${page}`\r\n      })\r\n    };\r\n\r\n    setPages(pages)\r\n  }, [productos])\r\n\r\n\r\n  const fetchData = async (url) => {\r\n    setPageActive(url);\r\n    try{\r\n      const data = await request(url);\r\n      setProductos(data);\r\n    }catch(error){\r\n      console.log(\"Ah ocurrido un error\");\r\n    };\r\n  };\r\n\r\n  const handleDelete = async (id) => {\r\n    try{\r\n      await deleteProducto(id);\r\n      const dataProductoEliminado = productos['results'].filter((producto) => producto.id != id)\r\n      setProductos((prevState) => ({\r\n        ...prevState,\r\n        results:dataProductoEliminado\r\n      }));\r\n    }catch (err){\r\n      alert('Ah ocurrido un error');\r\n    };\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchData('http://127.0.0.1:8000/agencia/servicios/');\r\n  }, []);\r\n\r\n  return (\r\n    <Layouts>\r\n        <Navbar/>\r\n        <div className='pt-14 container mx-auto'>\r\n          <div className='grid grid-cols-4 gap-x-4 gap-y-10'>\r\n\r\n            {\r\n              productos['results']?.map((producto)=> (\r\n                <div class=\"flex flex-col mt-6 text-gray-700 bg-gray-100 shadow-md bg-clip-border rounded-xl w-80\">\r\n                  <div\r\n                    class=\"relative h-56 mx-4 -mt-6 overflow-hidden text-white shadow-lg bg-clip-border rounded-xl bg-blue-gray-500 shadow-blue-gray-500/40\">\r\n                    {\r\n                      producto.foto && (\r\n                        <img src={producto.foto} className='object-cover w-full h-full' alt=\"\"/>\r\n                      )\r\n                    }\r\n                  </div>\r\n                  <div class=\"p-6\">\r\n                    <h5 class=\"block mb-2 font-sans text-xl antialiased font-semibold leading-snug tracking-normal text-blue-gray-900\">\r\n                      {producto.nombre}\r\n                    </h5>\r\n                    <p class=\"block font-sans text-base antialiased font-light leading-relaxed text-inherit\">\r\n                      {producto.descripcion}\r\n                    </p>\r\n                  </div>\r\n                  <div class=\"p-6 pt-0\">\r\n                    <button\r\n                      class=\"align-middle select-none font-sans font-bold text-center uppercase transition-all disabled:opacity-50 disabled:shadow-none disabled:pointer-events-none text-xs py-3 px-6 rounded-lg bg-gray-900 text-white shadow-md shadow-gray-900/10 hover:shadow-lg hover:shadow-gray-900/20 focus:opacity-[0.85] focus:shadow-none active:opacity-[0.85] active:shadow-none\"\r\n                      onClick={() => handleDelete(producto.id)}\r\n                    >\r\n                      Eliminar producto\r\n                    </button>\r\n                  </div>\r\n                </div>  \r\n              ))\r\n            }\r\n          </div>\r\n          <div className='text-center py-2 bg-gray-100 my-2 rounded-lg'>\r\n          {\r\n              productos['previous']\r\n              ? \r\n                <button className=\"bg-blue-500 hover:bg-blue-700 text-white cursor-pointer font-bold py-1.5 px-3 rounded\" onClick={() => fetchData(productos['previous'])}>\r\n                  Anterior\r\n                </button>\r\n              :\r\n                <button className=\"bg-gray-200 hover:bg-gray-100 text-gray-400 font-bold py-1.5 px-3 rounded\">\r\n                  Anterior\r\n                </button>\r\n            }\r\n      \r\n            {\r\n              pages.map((page) => (\r\n                <>\r\n                  <button className=\"hover:underline text-blue-600 font-bold py-2 px-4 rounded\" onClick={() => fetchData(page['url'])}>\r\n                    {page['numberPage']}\r\n                  </button>\r\n                </>\r\n              ))\r\n            }\r\n            { \r\n              productos['next']\r\n              ?\r\n                <button className=\"bg-blue-500 hover:bg-blue-700 text-white font-bold py-1.5 px-3 rounded\" onClick={() => fetchData(productos['next'])}>\r\n                  Siguiente\r\n                </button>\r\n              :\r\n                <button className=\"bg-gray-200 hover:bg-gray-100 text-gray-400 font-bold py-1.5 px-3 rounded\">\r\n                    Siguiente\r\n                </button>\r\n            }\r\n\r\n          </div>\r\n          \r\n            \r\n        </div>\r\n        <Footer/>\r\n    </Layouts>\r\n  )\r\n}\r\n\r\nexport default Home"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}