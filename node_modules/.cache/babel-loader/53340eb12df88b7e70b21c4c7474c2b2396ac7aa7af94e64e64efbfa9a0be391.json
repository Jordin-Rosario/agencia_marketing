{"ast":null,"code":"import Footer from'components/navigations/Footer';import Navbar from'components/navigations/Navbar';import Layouts from'hocs/layouts/Layouts';import React,{useEffect,useState}from'react';import{getCookie}from'components/navigations/csrf_token';import{jsx as _jsx,Fragment as _Fragment,jsxs as _jsxs}from\"react/jsx-runtime\";const request=async url=>{const res=await fetch(url);if(!res.ok){throw new Error('Error en la solicitud');}const data=await res.json();return data;};const deleteProducto=async id=>{try{const csrfToken=getCookie('csrftoken');const response=await fetch(`http://127.0.0.1:8000/agencia/servicios/${id}/`,{method:'DELETE',headers:{'Content-Type':'application/json','X-CSRFToken':csrfToken// Incluye el token CSRF en el encabezado\n}});if(!response.ok){throw new Error('Error en la solicitud');}return response;// Devuelve la respuesta de la solicitud\n}catch(error){console.error(\"Hubo un error al eliminar el usuario:\",error);throw error;// Lanza el error para que el componente lo maneje\n}};const Home=()=>{var _productos$results;const[productos,setProductos]=useState({});const[pages,setPages]=useState([]);const[pageActive,setPageActive]=useState();console.log(pageActive);useEffect(()=>{let calPages=productos['count']/5;calPages=!calPages%2==0?calPages+1:calPages;const pages=[];for(let page=1;page<calPages;page++){pages.push({numberPage:page,url:`http://127.0.0.1:8000/agencia/servicios/?page=${page}`});};setPages(pages);},[productos]);const fetchData=async url=>{setPageActive(url);try{const data=await request(url);setProductos(data);}catch(error){console.log(\"Ah ocurrido un error\");};};const handleDelete=async id=>{try{await deleteProducto(id);alert('Se elimino correctamente');const dataProductoEliminado=productos.filter(producto=>producto.id!==id);setProductos(dataProductoEliminado);}catch{alert('Ah ocurrido un error');};};useEffect(()=>{fetchData('http://127.0.0.1:8000/agencia/servicios/');},[]);return/*#__PURE__*/_jsxs(Layouts,{children:[/*#__PURE__*/_jsx(Navbar,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"pt-28 container\",children:[(_productos$results=productos['results'])===null||_productos$results===void 0?void 0:_productos$results.map(producto=>/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-black\",children:producto.nombre}),/*#__PURE__*/_jsx(\"p\",{className:\"text-black\",children:producto.descripcion}),/*#__PURE__*/_jsx(\"button\",{className:\"underline text-red-600\",onClick:()=>handleDelete(producto.id),children:\"Eliminar producto\"})]})),productos['previous']?/*#__PURE__*/_jsx(\"button\",{className:\"bg-blue-500 hover:bg-blue-700 text-white cursor-pointer font-bold py-1.5 px-3 rounded\",onClick:()=>fetchData(productos['previous']),children:\"Anterior\"}):/*#__PURE__*/_jsx(\"button\",{className:\"bg-gray-200 hover:bg-gray-100 text-gray-400 font-bold py-1.5 px-3 rounded\",children:\"Anterior\"}),pages.map(page=>/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"button\",{className:\"hover:underline text-blue-600 font-bold py-2 px-4 rounded\",onClick:()=>fetchData(page['url']),children:page['numberPage']})})),productos['next']?/*#__PURE__*/_jsx(\"button\",{className:\"bg-blue-500 hover:bg-blue-700 text-white font-bold py-1.5 px-3 rounded\",onClick:()=>fetchData(productos['next']),children:\"Siguiente\"}):/*#__PURE__*/_jsx(\"button\",{className:\"bg-gray-200 hover:bg-gray-100 text-gray-400 font-bold py-1.5 px-3 rounded\",children:\"Siguiente\"})]}),/*#__PURE__*/_jsx(Footer,{})]});};export default Home;","map":{"version":3,"names":["Footer","Navbar","Layouts","React","useEffect","useState","getCookie","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","request","url","res","fetch","ok","Error","data","json","deleteProducto","id","csrfToken","response","method","headers","error","console","Home","_productos$results","productos","setProductos","pages","setPages","pageActive","setPageActive","log","calPages","page","push","numberPage","fetchData","handleDelete","alert","dataProductoEliminado","filter","producto","children","className","map","nombre","descripcion","onClick"],"sources":["C:/Users/Opdbd09/Desktop/agencia_marketing/src/containers/pages/Home.jsx"],"sourcesContent":["import Footer from 'components/navigations/Footer'\r\nimport Navbar from 'components/navigations/Navbar'\r\nimport Layouts from 'hocs/layouts/Layouts'\r\nimport React, {useEffect, useState} from 'react'\r\nimport { getCookie } from 'components/navigations/csrf_token'\r\n\r\nconst request = async (url) => {\r\n  const res = await fetch(url)\r\n  if (!res.ok) {\r\n    throw new Error('Error en la solicitud');\r\n  }\r\n  const data = await res.json();\r\n  return data\r\n}\r\n\r\nconst deleteProducto = async (id) => {\r\n  try {\r\n    const csrfToken = getCookie('csrftoken'); \r\n\r\n    const response = await fetch(`http://127.0.0.1:8000/agencia/servicios/${id}/`, {\r\n      method: 'DELETE',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        'X-CSRFToken': csrfToken // Incluye el token CSRF en el encabezado\r\n      },\r\n    });\r\n\r\n    if (!response.ok) {\r\n      throw new Error('Error en la solicitud');\r\n    }\r\n\r\n    return response; // Devuelve la respuesta de la solicitud\r\n  } catch (error) {\r\n    console.error(\"Hubo un error al eliminar el usuario:\", error);\r\n    throw error; // Lanza el error para que el componente lo maneje\r\n  }\r\n};\r\n\r\nconst Home = () => {\r\n  const [productos, setProductos] = useState({});\r\n  const [pages, setPages] = useState([]);\r\n  const [pageActive, setPageActive] = useState();\r\n  console.log(pageActive);\r\n\r\n  useEffect(() => {\r\n    let calPages = productos['count'] / 5\r\n    calPages = !calPages % 2 == 0 ? calPages + 1: calPages \r\n  \r\n    const pages = []\r\n    for (let page = 1; page < calPages; page++) {\r\n      pages.push({\r\n        numberPage:page,\r\n        url:`http://127.0.0.1:8000/agencia/servicios/?page=${page}`\r\n      })\r\n    };\r\n\r\n    setPages(pages)\r\n  }, [productos])\r\n\r\n\r\n  const fetchData = async (url) => {\r\n    setPageActive(url);\r\n    try{\r\n      const data = await request(url);\r\n      setProductos(data);\r\n    }catch(error){\r\n      console.log(\"Ah ocurrido un error\");\r\n    };\r\n  };\r\n\r\n  const handleDelete = async (id) => {\r\n    try{\r\n      await deleteProducto(id);\r\n      alert('Se elimino correctamente');\r\n      const dataProductoEliminado = productos.filter((producto) => producto.id !== id)\r\n      setProductos(dataProductoEliminado);\r\n    }catch{\r\n      alert('Ah ocurrido un error');\r\n    };\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchData('http://127.0.0.1:8000/agencia/servicios/');\r\n  }, []);\r\n\r\n  return (\r\n    <Layouts>\r\n        <Navbar/>\r\n        <div className='pt-28 container'>\r\n            {\r\n              productos['results']?.map((producto)=> (\r\n                <>\r\n                  <h1 className='text-black'>{producto.nombre}</h1>\r\n                  <p className='text-black'>{producto.descripcion}</p>\r\n                  <button\r\n                    className='underline text-red-600'\r\n                    onClick={() => handleDelete(producto.id)}\r\n                  >\r\n                    Eliminar producto\r\n                  </button>\r\n                </>\r\n              ))\r\n            }\r\n            {\r\n              productos['previous']\r\n              ? \r\n                <button className=\"bg-blue-500 hover:bg-blue-700 text-white cursor-pointer font-bold py-1.5 px-3 rounded\" onClick={() => fetchData(productos['previous'])}>\r\n                  Anterior\r\n                </button>\r\n              :\r\n                <button className=\"bg-gray-200 hover:bg-gray-100 text-gray-400 font-bold py-1.5 px-3 rounded\">\r\n                  Anterior\r\n                </button>\r\n            }\r\n      \r\n            {\r\n              pages.map((page) => (\r\n                <>\r\n                  <button className=\"hover:underline text-blue-600 font-bold py-2 px-4 rounded\" onClick={() => fetchData(page['url'])}>\r\n                    {page['numberPage']}\r\n                  </button>\r\n                </>\r\n              ))\r\n            }\r\n            { \r\n              productos['next']\r\n              ?\r\n                <button className=\"bg-blue-500 hover:bg-blue-700 text-white font-bold py-1.5 px-3 rounded\" onClick={() => fetchData(productos['next'])}>\r\n                  Siguiente\r\n                </button>\r\n              :\r\n                <button className=\"bg-gray-200 hover:bg-gray-100 text-gray-400 font-bold py-1.5 px-3 rounded\">\r\n                    Siguiente\r\n                </button>\r\n            }\r\n            \r\n        </div>\r\n        <Footer/>\r\n    </Layouts>\r\n  )\r\n}\r\n\r\nexport default Home"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}