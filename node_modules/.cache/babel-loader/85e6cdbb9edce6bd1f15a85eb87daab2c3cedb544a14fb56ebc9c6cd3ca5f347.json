{"ast":null,"code":"import Footer from'components/navigations/Footer';import Navbar from'components/navigations/Navbar';import Layouts from'hocs/layouts/Layouts';import React,{useEffect,useState}from'react';import{Link}from'react-router-dom';// Función para obtener la cookie CSRF\nimport{jsx as _jsx,Fragment as _Fragment,jsxs as _jsxs}from\"react/jsx-runtime\";function getCookie(name){let cookieValue=null;if(document.cookie&&document.cookie!==''){const cookies=document.cookie.split(';');for(let i=0;i<cookies.length;i++){const cookie=cookies[i].trim();if(cookie.startsWith(name+'=')){cookieValue=decodeURIComponent(cookie.substring(name.length+1));break;}}}return cookieValue;}const request=async url=>{const res=await fetch(url);if(!res.ok){throw new Error('Error en la solicitud');}const data=await res.json();return data;};const deleteProducto=async id=>{try{const csrfToken=getCookie('csrftoken');console.log(csrfToken,'-----------');const response=await fetch(`http://127.0.0.1:8000/agencia/servicios/${id}/`,{method:'DELETE',headers:{'Content-Type':'application/json','X-CSRFToken':csrfToken// Incluye el token CSRF en el encabezado\n}});if(!response.ok){throw new Error('Error en la solicitud');}return response;// Devuelve la respuesta de la solicitud\n}catch(error){console.error(\"Hubo un error al eliminar el usuario:\",error);throw error;// Lanza el error para que el componente lo maneje\n}};const Home=()=>{var _productos$results;const[productos,setProductos]=useState({});const[pages,setPages]=useState([]);const[pageActive,setPageActive]=useState();useEffect(()=>{let calPages=productos['count']/5;calPages=!calPages%2==0?calPages+1:calPages;const pages=[];for(let page=1;page<calPages;page++){pages.push({numberPage:page,url:`http://127.0.0.1:8000/agencia/servicios/?page=${page}`});};setPages(pages);},[productos]);const fetchData=async url=>{try{const data=await request(url);setProductos(data);}catch(error){console.log(\"Ah ocurrido un error\");};};const handleDelete=async id=>{try{await deleteProducto(id);alert('Se elimino correctamente');}catch{alert('Ah ocurrido un error');};};useEffect(()=>{fetchData('http://127.0.0.1:8000/agencia/servicios/');},[]);return/*#__PURE__*/_jsxs(Layouts,{children:[/*#__PURE__*/_jsx(Navbar,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"pt-28\",children:[(_productos$results=productos['results'])===null||_productos$results===void 0?void 0:_productos$results.map(producto=>/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-black\",children:producto.nombre}),/*#__PURE__*/_jsx(\"p\",{className:\"text-black\",children:producto.descripcion}),/*#__PURE__*/_jsx(\"button\",{className:\"underline text-red-600\",onClick:()=>handleDelete(producto.id),children:\"Eliminar producto\"})]})),productos['previous']?/*#__PURE__*/_jsx(\"button\",{className:\"bg-blue-500 hover:bg-blue-700 text-white cursor-pointer font-bold py-2 px-4 rounded\",onClick:()=>fetchData(productos['previous']),children:\"Anterior\"}):/*#__PURE__*/_jsx(\"button\",{className:\"bg-gray-200 hover:bg-gray-100 text-gray-400 font-bold py-2 px-4 rounded\",children:\"Anterior\"}),pages.map(page=>/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"button\",{className:\"hover:underline text-blue-600 font-bold py-2 px-4 rounded\",onClick:()=>fetchData(page['url']),children:page['numberPage']})})),productos['next']?/*#__PURE__*/_jsx(\"button\",{className:\"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded\",onClick:()=>fetchData(productos['next']),children:\"Siguiente\"}):/*#__PURE__*/_jsx(\"button\",{className:\"bg-gray-200 hover:bg-gray-100 text-gray-400 font-bold py-2 px-4 rounded\",children:\"Siguiente\"})]}),/*#__PURE__*/_jsx(Footer,{})]});};export default Home;","map":{"version":3,"names":["Footer","Navbar","Layouts","React","useEffect","useState","Link","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","getCookie","name","cookieValue","document","cookie","cookies","split","i","length","trim","startsWith","decodeURIComponent","substring","request","url","res","fetch","ok","Error","data","json","deleteProducto","id","csrfToken","console","log","response","method","headers","error","Home","_productos$results","productos","setProductos","pages","setPages","pageActive","setPageActive","calPages","page","push","numberPage","fetchData","handleDelete","alert","children","className","map","producto","nombre","descripcion","onClick"],"sources":["C:/Users/Opdbd09/Desktop/agencia_marketing/src/containers/pages/Home.jsx"],"sourcesContent":["import Footer from 'components/navigations/Footer'\r\nimport Navbar from 'components/navigations/Navbar'\r\nimport Layouts from 'hocs/layouts/Layouts'\r\nimport React, {useEffect, useState} from 'react'\r\nimport { Link } from 'react-router-dom'\r\n\r\n// Función para obtener la cookie CSRF\r\nfunction getCookie(name) {\r\n  let cookieValue = null;\r\n  if (document.cookie && document.cookie !== '') {\r\n    const cookies = document.cookie.split(';');\r\n    for (let i = 0; i < cookies.length; i++) {\r\n      const cookie = cookies[i].trim();\r\n      if (cookie.startsWith(name + '=')) {\r\n        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));\r\n        break;\r\n      }\r\n    }\r\n  }\r\n  return cookieValue;\r\n}\r\n\r\nconst request = async (url) => {\r\n  const res = await fetch(url)\r\n  if (!res.ok) {\r\n    throw new Error('Error en la solicitud');\r\n  }\r\n  const data = await res.json();\r\n  return data\r\n}\r\n\r\nconst deleteProducto = async (id) => {\r\n  try {\r\n    const csrfToken = getCookie('csrftoken'); \r\n    console.log(csrfToken, '-----------')\r\n    const response = await fetch(`http://127.0.0.1:8000/agencia/servicios/${id}/`, {\r\n      method: 'DELETE',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        'X-CSRFToken': csrfToken // Incluye el token CSRF en el encabezado\r\n      },\r\n    });\r\n\r\n    if (!response.ok) {\r\n      throw new Error('Error en la solicitud');\r\n    }\r\n\r\n    return response; // Devuelve la respuesta de la solicitud\r\n  } catch (error) {\r\n    console.error(\"Hubo un error al eliminar el usuario:\", error);\r\n    throw error; // Lanza el error para que el componente lo maneje\r\n  }\r\n};\r\n\r\nconst Home = () => {\r\n  const [productos, setProductos] = useState({});\r\n  const [pages, setPages] = useState([]);\r\n  const [pageActive, setPageActive] = useState();\r\n\r\n  useEffect(() => {\r\n    let calPages = productos['count'] / 5\r\n    calPages = !calPages % 2 == 0 ? calPages + 1: calPages \r\n  \r\n    const pages = []\r\n    for (let page = 1; page < calPages; page++) {\r\n      pages.push({\r\n        numberPage:page,\r\n        url:`http://127.0.0.1:8000/agencia/servicios/?page=${page}`\r\n      })\r\n    };\r\n\r\n    setPages(pages)\r\n  }, [productos])\r\n\r\n\r\n  const fetchData = async (url) => {\r\n    try{\r\n      const data = await request(url);\r\n      setProductos(data);\r\n    }catch(error){\r\n      console.log(\"Ah ocurrido un error\")\r\n    };\r\n  };\r\n\r\n  const handleDelete = async (id) => {\r\n    try{\r\n      await deleteProducto(id);\r\n      alert('Se elimino correctamente');\r\n    }catch{\r\n      alert('Ah ocurrido un error');\r\n    };\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchData('http://127.0.0.1:8000/agencia/servicios/');\r\n  }, []);\r\n\r\n  return (\r\n    <Layouts>\r\n        <Navbar/>\r\n        <div className='pt-28'>\r\n            {\r\n              productos['results']?.map((producto)=> (\r\n                <>\r\n                  <h1 className='text-black'>{producto.nombre}</h1>\r\n                  <p className='text-black'>{producto.descripcion}</p>\r\n                  <button\r\n                    className='underline text-red-600'\r\n                    onClick={() => handleDelete(producto.id)}\r\n                  >\r\n                    Eliminar producto\r\n                  </button>\r\n                </>\r\n              ))\r\n            }\r\n            {\r\n              productos['previous']\r\n              ? \r\n                <button className=\"bg-blue-500 hover:bg-blue-700 text-white cursor-pointer font-bold py-2 px-4 rounded\" onClick={() => fetchData(productos['previous'])}>\r\n                  Anterior\r\n                </button>\r\n              :\r\n                <button className=\"bg-gray-200 hover:bg-gray-100 text-gray-400 font-bold py-2 px-4 rounded\">\r\n                  Anterior\r\n                </button>\r\n            }\r\n      \r\n            {\r\n              pages.map((page) => (\r\n                <>\r\n                  <button className=\"hover:underline text-blue-600 font-bold py-2 px-4 rounded\" onClick={() => fetchData(page['url'])}>\r\n                    {page['numberPage']}\r\n                  </button>\r\n                </>\r\n              ))\r\n            }\r\n            { \r\n              productos['next']\r\n              ?\r\n                <button className=\"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded\" onClick={() => fetchData(productos['next'])}>\r\n                  Siguiente\r\n                </button>\r\n              :\r\n                <button className=\"bg-gray-200 hover:bg-gray-100 text-gray-400 font-bold py-2 px-4 rounded\">\r\n                    Siguiente\r\n                </button>\r\n            }\r\n            \r\n        </div>\r\n        <Footer/>\r\n    </Layouts>\r\n  )\r\n}\r\n\r\nexport default Home"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}